---
layout:            post
title:             "WebtoB - SSL적용 및 Redirect 시키기"
menutitle:         "WebtoB - SSL적용 및 Redirect 시키기"
tags:              Server
category:          Server
author:            geunyoung
cover:             /assets/mountain-alternative-cover.jpg
published:         true
cover:             /assets/mountain-alternative-cover.jpg
language:          KO
comments:          true
math:		   false
---

## SSL 적용하기

우선 설정은 역시 webtob의 config파일에 있는 http.m에서 한다.

우선 SSL부터 등록해보자

```xml
*SSL
SSL명
CertificateFile="인증서 경로 및 파일명",
CertificateKeyFile="인증키 경로 및 파일명",
CACertificateFile="CA 경로 및 파일명",
Protocols="-SSLv2, -SSLv3",
PassPhraseDialog= "(옵션)비밀번호 자동으로 인증하고 싶으면 exec:명령어 저장되어 있는 경로 및 파일명"
```

만약 인증서, 인증키, CA의 의미가 헷갈린다면 SSL이란 제목의 포스트 참고하자

PassPhraseDialog에 저장되어 있는 내용은

```text

echo "암호"

```

원래 webtob 껏다 켯다할때 비밀번호 계속 입력해야 하는데 이 설정을 하면 자동적으로 입력된다. 평문으로 저장하면 이 후 보안이슈가 있을 것같아 암호화하려 했지만 암호화시 특수문자로 제대로 인식하지 못해 포기하고 이후 암호화 이슈생기면 해당 내용을 제거하기로 결정하였다.

이 인증을 이제 VHOST에다 적용시켜야한다.

```xml
*VHOST
가상호스트명	   
DOCROOT="/jeus/webtob/docs",
HOSTNAME = "도메인 명",
HOSTALIAS = "도메인에 매핑할 IP",
PORT = "도메인에 매핑할 포트",
SSLFLAG = Y,
SSLNAME = "SSL명",
ServiceOrder = "uri,ext",
ERRORDOCUMENT = "400,401,403,404,405,406,503",
METHOD = "GET, POST, HEAD, -OPTIONS",
LOGGING = "acc_App",
ERRORLOG = "err_App"
```

## Redirect 적용하기

이 설정 또한 webtob의 config파일에 있는 http.m에서 한다.

가상 호스트에서 아래의 내용추가

```xml
*VHOST
가상호스트명	   
DOCROOT="/jeus/webtob/docs",
HOSTNAME = "도메인 명",
HOSTALIAS = "도메인에 매핑할 IP",
PORT = "도메인에 매핑할 포트",
SSLFLAG = Y,
SSLNAME = "SSL명",
ServiceOrder = "uri,ext",
URLRewrite = Y,
URLRewriteConfig = "Redirect 설정 경로 및 파일명",
ERRORDOCUMENT = "400,401,403,404,405,406,503",
METHOD = "GET, POST, HEAD, -OPTIONS",
LOGGING = "acc_App",
ERRORLOG = "err_App"
```

## 원인

분명 문제가 없어보이는데 왜 안되는 거지? 혹시 foreach문이 잘못되었나? 하며 루프문에 대해 검색해가며 원인을 찾아보려했지만 해결이 할 수 없었다.
원인을 바로바로!!!
변수를 받는 #{item}에 있었다. #{}로 선언을 하면 mybatis문법상 ''를 붙여서 쿼리가 실행이 된다는 것이다.
즉, select 'a','b','c' from BBB으로 인식이 된것이다.
${}으로 수정하니 정상작동하였다.



