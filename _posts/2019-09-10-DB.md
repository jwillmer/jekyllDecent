---
layout:            post
title:             "Hint 구문의 활용"
menutitle:         "Hint 구문의 활용"
tags:              oracle
category:          DataBase
author:            geunyoung
cover:             /assets/mountain-alternative-cover.jpg
published:         true
cover:             /assets/mountain-alternative-cover.jpg
language:          KO
comments:          true
---

## 들어가기 앞서...

8월에 작성했던 포스팅인 'DB툴에선 빠른데 프로젝트에선 느리다?' 편에서 문제되었던 쿼리가 특정 조건에서는 이전과 동일하게 DB툴과의 속도가 차이가 생겼다.
더욱이 난해했던 것이 개발서버에서는 같은 프로세스를 밣았는데도 속도가 빠른 것이었다.
따라서 운영에 배포하여 테스트를 진행해야 하는데, 확실한 문제 부분을 찾지 못한 상태에서 무턱대고 배포할 수 없으니 난감한 상황이었다.
그러가 아래의 블로그를 보았고 해당 블로그에 단서를 얻어 문제점을 해결 할 수 있었다.
 - https://m.blog.naver.com/PostView.nhn?blogId=mittchan&logNo=220030192267&proxyReferer=https%3A%2F%2Fwww.google.com%2F

결론부터 말하자면 hint 구문을 추가해주면서 해결되었다. 
그렇다면 hint 구문이란 무엇이고 어떤 역할을 하는지 알아보자!

### Hint

저번 포스팅인 'DB툴에선 빠른데 프로젝트에선 느리다?' 편에서 말했듯이 옵티마이저가 쿼리를 제어하면서 해당 쿼리가 최대한 빨리 실행되게끔 계획(Plan)을 짜고 실행을 한다.
Hint란 옵티머이저의 실행 계획을 따르지 않고 사용자가 직접 실행 계획을 관여할 수 있게 만드는 구문이다.
조인을 할 때 사용하는 구문인 'join hint', 쿼리에 대한 구문이 'query hint', 테이블에 대한 힌트인 'table hint' 등이 있다.

### MSSQL Hint

아직 MSSQL을 사용하는 시스템에서 위와 같은 문제가 발생한 적이 없어서 깊게 고민하지 못하였지만 아래의 블로그에 정말 상세하게 설명되어 있다. 참고바란다.
 - https://splee75.tistory.com/10

그렇


문제된 시스템은 WebtoB/JEUS 시스템이었다.

JEUS는 Default 세팅에서 시작시 DB connection을 못 맺는다면 서버실행이 안되게끔 되어 있다.
따라서 해당 세팅을 바꿔줘야 한다.

Webadmin의 메인 -> Servers -> 해당 Server -> Basic -> Basic Info -> Jvm Option에서

-Djeus.servlet.ignoreWebComponentFailureWhenDeploying=true

을 추가해준다.

<aside>
<figure>
<img src="{{ "/media/img/Server/jeus1.PNG" | absolute_url }}" />>
</figure>
</aside>

이후 서버를 재시작



### 수정 2

이 부분은 아마 JEUS 외에도 Tomcat, Websphere에서도 통용될 부분이라고 생각되는 데, Validation query를 제거해준다.

tomcat일 경우, context.xml 혹은 server.xml 등 datasource를 정의 해주는 곳에 존재하고

websphere는 JNDI 세팅 탭에 존재하며,

JEUS는 

Webadmin의 메인 -> Resources -> Data source -> 해당 Data source -> connection pool 탭 -> Connection Validation 체크박스 해제

<aside>
<figure>
<img src="{{ "/media/img/Server/jeus2.PNG" | absolute_url }}" />>
</figure>
</aside>


### 느낀 점

알고 있는 내용이었다면 민첩하게 대응할 수 있는 부분이지만 생각을 깊게 못해본 부분이라 대응이 늦었었다. 초심 잃지말고 열심히 공부하자!
